<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendario con Reproductor</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        .calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            max-width: 600px;
            margin: 0 auto;
        }
        .day {
            padding: 10px;
            border: 1px solid #ccc;
            text-align: center;
            cursor: pointer;
        }
        .day:hover {
            background-color: #f0f0f0;
        }
        .day-name {
            padding: 10px;
            border: 1px solid #ccc;
            text-align: center;
            font-weight: bold;
            background-color: #f0f0f0;
        }
        #player {
            margin-top: 20px;
            text-align: center;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            max-width: 600px;
            margin: 0 auto 20px;
        }
        .navigation button {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
        }
        .navigation input[type="month"] {
            padding: 5px;
            font-size: 16px;
        }
    </style>
</head>
<body>

    <h1>Calendario</h1>

    <div class="navigation">
        <button id="prevMonth">&lt;</button>
        <input type="month" id="monthSelector">
        <button id="nextMonth">&gt;</button>
    </div>

    <div class="calendar" id="calendar">
        <!-- Nombres de los días de la semana -->
        <div class="day-name">Dom</div>
        <div class="day-name">Lun</div>
        <div class="day-name">Mar</div>
        <div class="day-name">Mié</div>
        <div class="day-name">Jue</div>
        <div class="day-name">Vie</div>
        <div class="day-name">Sáb</div>
    </div>

    <div id="player" style="display: none;">
        <h2>Reproductor</h2>
        <audio controls id="audioPlayer">
            Tu navegador no soporta el elemento de audio.
        </audio>
        <div id="playlist"></div>
    </div>

    <script>
        // Variables globales
        let currentDate = new Date(); // Fecha actual
        let currentMonth = currentDate.getMonth(); // Mes actual (0-11)
        let currentYear = currentDate.getFullYear(); // Año actual

        // Elementos del DOM
        const calendar = document.getElementById('calendar');
        const monthSelector = document.getElementById('monthSelector');
        const prevMonthButton = document.getElementById('prevMonth');
        const nextMonthButton = document.getElementById('nextMonth');
        const player = document.getElementById('player');
        const audioPlayer = document.getElementById('audioPlayer');
        const playlist = document.getElementById('playlist');

        // Inicializar el calendario
        function initCalendar() {
            renderCalendar(currentYear, currentMonth);
            monthSelector.value = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}`;
        }

        // Función para verificar si un año es bisiesto
        function isLeapYear(year) {
            return (year % 4 === 0 && year % 100 !== 0) || year % 400 === 0;
        }

        // Función para obtener el número de días en un mes
        function getDaysInMonth(year, month) {
            if (month === 1) { // Febrero
                return isLeapYear(year) ? 29 : 28;
            }
            return new Date(year, month + 1, 0).getDate();
        }

        // Renderizar el calendario
        function renderCalendar(year, month) {
            // Limpiar el calendario (excepto los nombres de los días)
            while (calendar.children.length > 7) {
                calendar.removeChild(calendar.lastChild);
            }

            // Obtener el primer día del mes y el número de días en el mes
            const firstDayOfMonth = new Date(year, month, 1);
            const daysInMonth = getDaysInMonth(year, month);
            const firstDayOfWeek = firstDayOfMonth.getDay(); // 0 = Domingo, 1 = Lunes, ..., 6 = Sábado

            // Crear días vacíos para la primera semana
            for (let i = 0; i < firstDayOfWeek; i++) {
                const emptyDay = document.createElement('div');
                calendar.appendChild(emptyDay);
            }

            // Crear los días del mes
            for (let day = 1; day <= daysInMonth; day++) {
                const dayElement = document.createElement('div');
                dayElement.classList.add('day');
                dayElement.textContent = day;
                dayElement.addEventListener('click', () => loadPlayer(year, month + 1, day));
                calendar.appendChild(dayElement);
            }
        }

        // Función para cargar el reproductor
        function loadPlayer(year, month, day) {
            player.style.display = 'block';
            playlist.innerHTML = ''; // Limpiar la lista de reproducción

            // Ruta base de los archivos de audio
            const basePath = `cal/${String(month).padStart(2, '0')}/${String(day).padStart(2, '0')}`;

            // Archivos de audio disponibles (puedes ajustar los años según sea necesario)
            const years = [2023, 2024, 2025];

            // Crear elementos de audio para cada año
            years.forEach((audioYear) => {
                const audioSrc = `${basePath}/${audioYear}.mp3`;
                const audioElement = document.createElement('audio');
                audioElement.controls = true;
                audioElement.src = audioSrc;
                audioElement.style.display = 'block';
                audioElement.style.marginBottom = '10px';
                playlist.appendChild(audioElement);
            });
        }

        // Navegación entre meses
        prevMonthButton.addEventListener('click', () => {
            currentMonth--;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            renderCalendar(currentYear, currentMonth);
            monthSelector.value = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}`;
        });

        nextMonthButton.addEventListener('click', () => {
            currentMonth++;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            renderCalendar(currentYear, currentMonth);
            monthSelector.value = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}`;
        });

        // Seleccionar mes desde el input
        monthSelector.addEventListener('change', (event) => {
            const [year, month] = event.target.value.split('-').map(Number);
            currentYear = year;
            currentMonth = month - 1; // Ajustar el mes (0-11)
            renderCalendar(currentYear, currentMonth);
        });

        // Inicializar el calendario al cargar la página
        initCalendar();
    </script>

</body>
</html>